<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Arch Linux Notes | 梦断代码</title>
  <meta name="viewport" content="width=device-width">
  <meta name="description" content="This is my notebook for some small tips and tricks when using Arch Linux.
Why Arch Linux?

It is fresh and simple in package dependency.

It has a powerful Arch User Repository and makes it easy for y">
<meta property="og:type" content="article">
<meta property="og:title" content="Arch Linux Notes">
<meta property="og:url" content="http://blog.zhanghai.me/arch-linux-notes/">
<meta property="og:site_name" content="梦断代码">
<meta property="og:description" content="This is my notebook for some small tips and tricks when using Arch Linux.
Why Arch Linux?

It is fresh and simple in package dependency.

It has a powerful Arch User Repository and makes it easy for y">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Arch Linux Notes">
<meta name="twitter:description" content="This is my notebook for some small tips and tricks when using Arch Linux.
Why Arch Linux?

It is fresh and simple in package dependency.

It has a powerful Arch User Repository and makes it easy for y">

  
    <link rel="alternative" href="/atom.xml" title="梦断代码" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">

  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  
</head>
<body>
  <div id="container">
    <div class="mobile-nav-panel">
	<i class="icon-reorder icon-large"></i>
</div>
<header id="header">
	<h1 class="blog-title">
		<a href="/">梦断代码</a>
	</h1>
	<nav class="nav">
		<ul>
			<li><a href="/">Home</a></li><li><a href="/archives">Archives</a></li>
			<li><a id="nav-search-btn" class="nav-icon" title="Search"></a></li>
			<li><a href="/atom.xml" id="nav-rss-link" class="nav-icon" title="RSS Feed"></a></li>
		</ul>
	</nav>
	<div id="search-form-wrap">
		<form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><input type="submit" value="&#xF002;" class="search-form-submit"><input type="hidden" name="q" value="site:http://blog.zhanghai.me"></form>
	</div>
</header>
    <div id="main">
      <article id="post-arch-linux-notes" class="post">
	<footer class="entry-meta-header">
		<span class="meta-elements date">
			<a href="/arch-linux-notes/" class="article-date">
  <time datetime="2014-11-03T06:18:11.000Z" itemprop="datePublished">11月 3 2014</time>
</a>
		</span>
		<span class="meta-elements author">张海</span>
		<div class="commentscount">
			
				<a href="http://blog.zhanghai.me/arch-linux-notes/#disqus_thread" class="article-comment-link">Comments</a>
			
		</div>
	</footer>
	
	<header class="entry-header">
		
  
    <h1 class="article-title entry-title" itemprop="name">
      Arch Linux Notes
    </h1>
  

	</header>
	<div class="entry-content">
		
    	<p>This is my notebook for some small tips and tricks when using Arch Linux.</p>
<h2 id="Why_Arch_Linux?">Why Arch Linux?</h2>
<ul>
<li><p>It is fresh and simple in package dependency.</p>
</li>
<li><p>It has a powerful Arch User Repository and makes it easy for you to make/modify your package.</p>
</li>
<li><p>It has a detailed Arch Wiki comprising useful experiences and recommendations.</p>
</li>
<li><p>It gets you to learn the basic knowledge required to be a Linux user/administrator/programmer.</p>
</li>
</ul>
<a id="more"></a>

<h2 id="NTFS_partitions_auto_mounting">NTFS partitions auto mounting</h2>
<ol>
<li><p>Use <code>gnome-disks</code>, select partition and click the settings button below, click and then modify mount options in the popup menu.</p>
</li>
<li><p>Install <code>ntfs-config</code> and enable auto mounting.</p>
</li>
</ol>
<h2 id="Make_programs_use_proxy">Make programs use proxy</h2>
<p>There are several ways to make a program proxied. Part of the following comes from <a href="https://wiki.archlinux.org/index.php/proxy_settings" target="_blank" rel="external">Arch Wiki</a>.</p>
<ul>
<li><p>Environment variables</p>
<p>  Some programs respect proxy set via environment variables.</p>
<p>  <!-- Unable to wrap a backtick code block in a list item. --></p>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> http_proxy=http://<span class="number">10.203</span>.<span class="number">0.1</span>:<span class="number">5187</span>/</div><div class="line"><span class="keyword">export</span> https_proxy=<span class="variable">$http_proxy</span></div><div class="line"><span class="keyword">export</span> ftp_proxy=<span class="variable">$http_proxy</span></div><div class="line"><span class="keyword">export</span> rsync_proxy=<span class="variable">$http_proxy</span></div><div class="line"><span class="keyword">export</span> no_proxy=<span class="string">"localhost,127.0.0.1,localaddress,.localdomain.com"</span></div></pre></td></tr></table></figure>

<p>  It is sometimes advised that you export these environment variables again, with their names upper cased.</p>
</li>
<li><p>Proxychains</p>
<p>  Install <a href="https://www.archlinux.org/packages/?name=proxychains-ng" target="_blank" rel="external">proxychains-ng</a>. Proxychains hooks some C library functions so that programs gets proxied. However the Java VM cannot be proxied this way.</p>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">proxychains &lt;YOUR_PROGRAM&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>Java</p>
<p>  From <a href="http://docs.oracle.com/javase/8/docs/technotes/guides/net/proxies.html" target="_blank" rel="external">the documentation of Java</a>:</p>
<ul>
<li><p>HTTP</p>
<ul>
<li><p>http.proxyHost: the host name of the proxy server</p>
</li>
<li><p>http.proxyPort: the port number, the default value being 80.</p>
</li>
<li><p>http.nonProxyHosts: a list of hosts that should be reached directly, bypassing the proxy. This is a list of patterns separated by ‘|’. The patterns may start or end with a ‘*’ for wildcards. Any host matching one of these patterns will be reached through a direct connection instead of through a proxy.</p>
</li>
</ul>
</li>
<li><p>HTTPS</p>
<ul>
<li><p>https.proxyHost</p>
<p>https.proxyPort</p>
</li>
</ul>
</li>
<li><p>FTP</p>
<ul>
<li><p>ftp.proxyHost (Typo in official documentation)</p>
</li>
<li><p>ftp.proxyPort</p>
</li>
<li><p>ftp.nonProxyHosts</p>
</li>
</ul>
</li>
<li><p>SOCKS</p>
<ul>
<li><p>socksProxyHost for the host name of the SOCKS proxy server</p>
</li>
<li><p>socksProxyPort for the port number, the default value being 1080</p>
</li>
<li><p>socksProxyVersion for the version of the SOCKS protocol, the default being 5, and alternatively 4 can be specified.</p>
</li>
</ul>
<p>Note: socksProxyVersion and more properties are documented at <a href="http://docs.oracle.com/javase/8/docs/technotes/guides/net/properties.html" target="_blank" rel="external">another documentation of Java</a>.</p>
<p>Sample usage:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">java -Dhttp.proxyHost=webcache.example.com -Dhttp.proxyPort=<span class="number">8080</span> -Dhttp.nonProxyHosts=”localhost|host.example.com”</div></pre></td></tr></table></figure>

</li>
</ul>
</li>
</ul>
<p>Note that you can tunnel http(s) request to local socks client using <a href="https://www.archlinux.org/packages/?name=delegate" target="_blank" rel="external">DeleGate</a>.</p>
<h2 id="GNOME_proxy_setting">GNOME proxy setting</h2>
<p>You can utilize GNOME’s proxy setting in <code>Settings &gt; Network</code> even if you use <code>netctl</code> instead of <code>Network Manager</code>. Both HTTP and SOCKS proxy are supported.</p>
<p>Note that the proxy setting will also be read and set to corresponding environment variables by <code>gnome-terminal</code>, and no option is offered to turn this behavior off. To avoid setting proxy environment variables, reset the environment variables in your <code>.bashrc</code>.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Unset global proxy set by gnome-terminal</span></div><div class="line"><span class="comment"># See https://github.com/GNOME/gnome-terminal/blob/master/src/terminal-util.c</span></div><div class="line"><span class="built_in">unset</span> http_proxy https_proxy ftp_proxy all_proxy no_proxy</div><div class="line"><span class="built_in">unset</span> HTTP_PROXY HTTPS_PROXY FTP_PROXY ALL_PROXY NO_PROXY</div></pre></td></tr></table></figure>

<h2 id="GNOME_online_account">GNOME online account</h2>
<p>You can log in your Google account and all the things will be configured and synchronized automatically to your laptop. It can be a huge boost for your work flow.</p>
<p>If you need a proxy to access Google, configure it as in the GNOME proxy setting section.</p>
<h2 id="DNS_and_resolvconf">DNS and resolvconf</h2>
<p>DNS is managed by <code>resolvconf</code> in Arch Linux. In order to supply your own DNS, edit <code>/etc/resolvconf.conf</code>.</p>
<p>There are two options you may normally want to specify:</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="setting">name_servers=<span class="value">&lt;DNS1&gt; #Prepended into DNS list</span></span></div><div class="line"><span class="setting">name_servers_append=<span class="value"><span class="string">"&lt;DNS2&gt; &lt;DNS3&gt; ..."</span></span></span></div></pre></td></tr></table></figure>

<p>After modification, you may want to execute <code>resolvconf -u</code> to update <code>resolv.conf</code>.</p>
<p>Note that <code>dhcpd</code> also setup DNS for interfaces via <code>resolvconf</code>, in <code>/run/resolvconf/interface/&lt;INTERFACE&gt;</code>. You can override its behavior by executing <code>dhcpcd -S domain_name_servers=&lt;DNS&gt;</code>, or inside <code>dhcpcd.conf</code>.</p>
<h2 id="Create_software_AP_(Access_Point),_a-k-a-_virtual_WiFi">Create software AP (Access Point), a.k.a. virtual WiFi</h2>
<p>Install AUR package <code>create_ap</code>; you may want to remove the <code>wifi.service</code> it automatically creates when installed and use your own.</p>
<p>Check the Capabilities section in <code>iw list</code> along with <code>/usr/share/doc/hostapd/hostapd.conf</code> to determine <code>ht_capab</code>.</p>
<p>Note that in ZJU, ZJUWLAN occupies channel 1 and 6, so you’d better specify another channel.</p>
<p>Sample systemd service:</p>
<p>File: <code>&lt;YOUR_SSID&gt;@.service</code></p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="title">[Unit]</span></div><div class="line"><span class="setting">Description=<span class="value">Create AP service for &lt;YOUR_SSID&gt;</span></span></div><div class="line"><span class="setting">After=<span class="value">network.target</span></span></div><div class="line"></div><div class="line"><span class="title">[Service]</span></div><div class="line"><span class="setting">Type=<span class="value">simple</span></span></div><div class="line"><span class="setting">ExecStart=<span class="value">/usr/bin/create_ap -c <span class="number">13</span> -w <span class="number">2</span> -m nat --ieee80211n --ht_capab [HT40-][HT40+][SMPS-STATIC][GF][SHORT-GI-<span class="number">20</span>][SHORT-GI-<span class="number">40</span>][DSSS_CCK-<span class="number">40</span>] &lt;YOUR_WLAN_INTERFACE&gt; %i &lt;YOUR_SSID&gt; &lt;YOUR_PASSPHRASE&gt;</span></span></div><div class="line"><span class="setting">ExecStop=<span class="value">pkill hostapd</span></span></div><div class="line"><span class="setting">KillSignal=<span class="value">SIGINT</span></span></div><div class="line"><span class="setting">Restart=<span class="value"><span class="keyword">on</span>-failure</span></span></div><div class="line"><span class="setting">RestartSec=<span class="value"><span class="number">5</span></span></span></div><div class="line"></div><div class="line"><span class="title">[Install]</span></div><div class="line"><span class="setting">WantedBy=<span class="value">multi-user.target</span></span></div></pre></td></tr></table></figure>

<p>However on my own machine, I cannot share a secure (with password) network.</p>
<h2 id="Raise_inotify_limit_for_IntelliJ_IDEA">Raise inotify limit for IntelliJ IDEA</h2>
<p>Write the following line to <code>/etc/sysctl.d/99-sysctl.conf</code></p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">fs.inotify.max_user_watches = 524288</div></pre></td></tr></table></figure>

<h2 id="Sysrq">Sysrq</h2>
<p>Write the following line to <code>/etc/sysctl.d/99-sysctl.conf</code> to enable all the sysrq operations.</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">kernel.sysrq = 1</div></pre></td></tr></table></figure>

<p>Reboot to make changes take effect, or execute <code>echo 1 &gt;/proc/sys/kernel/sysrq</code>.</p>
<p>Hold <code>Alt</code>, and press the following key sequence.</p>
<ol>
<li><code>SysRq</code></li>
<li><code>R</code>    unRaw</li>
<li><code>E</code>    tErminate</li>
<li><code>I</code>    kIll</li>
<li><code>S</code>    Sync</li>
<li><code>U</code>    Unmount</li>
<li><code>B</code>    reBoot</li>
</ol>
<p>Note that the key <code>C</code> can make your kernel panic immediately.</p>
<h2 id="Watch_FS_buffer_status">Watch FS buffer status</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">watch grep <span class="operator">-e</span> Dirty: <span class="operator">-e</span> Writeback: /proc/meminfo</div></pre></td></tr></table></figure>

<p>You can execute <code>sync</code> to flush the buffer immediately.</p>
<h2 id="Map_Alt_Gr_(Right_Alt)_to_Alt_in_tty">Map Alt Gr (Right Alt) to Alt in tty</h2>
<p>From <a href="https://wiki.archlinux.org/index.php/Keyboard_Configuration_in_Console_%28%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87%29" target="_blank" rel="external">Arch Wiki</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">cd</span> /usr/share/kbd/keymaps/i386/qwerty</div><div class="line">cp us.map.gz us-two-alt-keys.map.gz</div><div class="line">gunzip us-two-alt-keys.map.gz</div></pre></td></tr></table></figure>

<p>Edit <code>us-two-alt-keys.map</code>，replace <code>include &quot;linux-with-alt-and-altgr&quot;</code> with <code>include &quot;linux-with-two-alt-keys&quot;</code>.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gzip us-two-alt-keys.map</div></pre></td></tr></table></figure>

<p>Edit <code>/etc/vconsole.conf</code>, replace <code>KEYMAP=us</code> with <code>KEYMAP=us-two-alt-keys</code>.</p>
<p>Reboot.</p>
<h2 id="Execute_previous_commands_in_bash">Execute previous commands in bash</h2>
<p><code>Ctrl+R</code> (I-search backward in emacs) can let you quickly execute command in your history.</p>
<p><code>!!</code> is substituted to be the last command in your history, but be careful when using it, for example <code>echo !!</code> will lead to unexpected behavior if <code>!!</code> is substituted to be <code>something &amp;&amp; poweroff</code>, then <code>poweroff</code> will be executed. To avoid such cases, always wrap it with quotes, like <code>echo &#39;!!&#39;</code>.</p>
<h2 id="Input_tab_or_newline_character_in_bash">Input tab or newline character in bash</h2>
<p><code>Ctrl+V</code> in bash works as <code>Ctrl+Q</code> in emacs, which will insert the next character literally.</p>
<h2 id="Install_font">Install font</h2>
<p>From <a href="https://wiki.archlinux.org/index.php/Fonts" target="_blank" rel="external">Arch Wiki</a>:</p>
<p>Drop your font files into <code>~/.fonts/</code>, <code>cd</code> into that directory, and execute the following command.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">echo</span> -n <span class="string">"Updating font cache... "</span></div><div class="line">fc-cache &gt;/dev/null <span class="operator">-f</span></div><div class="line">mkfontscale</div><div class="line">mkfontdir</div><div class="line"><span class="built_in">echo</span> <span class="keyword">done</span></div></pre></td></tr></table></figure>

<h2 id="Analyze_boot_time">Analyze boot time</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">systemd-analyze blame</div><div class="line">systemd-analyze critical-chain</div></pre></td></tr></table></figure>

<p>For more information, see <code>man systemd-analyze</code>.</p>
<p>Sometimes man-db.service may slow down the booting drastically, see <a href="https://bbs.archlinux.org/viewtopic.php?pid=1409295" target="_blank" rel="external">this thread</a>, <a href="https://bugs.archlinux.org/task/41511" target="_blank" rel="external">this issue</a>, and <a href="https://bugs.archlinux.org/task/41688" target="_blank" rel="external">this issue</a>.</p>
<h2 id="System_backup_using_tar">System backup using tar</h2>
<p>Install AUR package <code>system-tar-and-restore</code>.</p>
<p>Example: <code>/etc/backup.conf</code></p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"># Configuration file for backup.sh script.</div><div class="line"># Place it in /etc/backup.conf and edit it to your needs.</div><div class="line"></div><div class="line"></div><div class="line"># Set the interface. Available options: cli dialog.</div><div class="line">BRinterface="cli"</div><div class="line"></div><div class="line"># Uncomment to disable colors.</div><div class="line">#BRnocolor="Yes"</div><div class="line"></div><div class="line"># Uncomment to enable verbose archiver output.</div><div class="line">#BRverb="Yes"</div><div class="line"></div><div class="line"># Set the destination directory. Default is /.</div><div class="line">BRFOLDER="/run/media/zh/ZH-HDD/"</div><div class="line"></div><div class="line"># Uncomment to set alternative archive name. Default is 'Backup-$(hostname)-$(date +%d-%m-%Y-%T)'.</div><div class="line">#BRNAME="my_backup"</div><div class="line"></div><div class="line"># Set the archiver. Available options: tar bsdtar.</div><div class="line">BRarchiver="tar"</div><div class="line"></div><div class="line"># Set the compressor. Available options: gzip bzip2 xz none.</div><div class="line">BRcompression="gzip"</div><div class="line"></div><div class="line"># Uncomment to keep /home's hidden files and folders only.</div><div class="line">#BRhome="No"</div><div class="line"></div><div class="line"># Uncomment to completely exclude /home directory. Use with BRhome="No".</div><div class="line">#BRhidden="No"</div><div class="line"></div><div class="line"># Uncomment to set additional archiver options.</div><div class="line">BR_USER_OPTS="--exclude=/var/cache/* --exclude=/home/zh/.cache/* --acls --xattrs"</div><div class="line"></div><div class="line"># Uncomment to disable genkernel check in gentoo.</div><div class="line">#BRgenkernel="No"</div><div class="line"></div><div class="line"># Uncomment to be quiet.</div><div class="line">#BRquiet="Yes"</div></pre></td></tr></table></figure>

<p>To start a backup, execute <code>backup.sh</code> as root.</p>
<h2 id="Rename_files_with_number">Rename files with number</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">find -name <span class="string">'*.png'</span> | sort -n -r | gawk <span class="string">'{ printf "mv %s %03d.png\n", $0, NR }'</span> | bash</div></pre></td></tr></table></figure>

<p>100 files, reversely:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">find -name <span class="string">'*.png'</span> | sort -n -r | gawk <span class="string">'{ printf "mv %s %03d.png\n", $0, 100 - NR }'</span> | bash</div></pre></td></tr></table></figure>

<p>Starting with 100:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">find -name <span class="string">'*.png'</span> | sort -n -r | gawk <span class="string">'{ printf "mv %s %03d.png\n", $0, 100 + NR }'</span> | bash</div></pre></td></tr></table></figure>

<h2 id="Shell_calculator">Shell calculator</h2>
<p>From <a href="http://askubuntu.com/questions/378661/any-command-line-calculator-for-ubuntu" target="_blank" rel="external">an AskUbuntu question</a>.</p>
<p>Add the following lines to your <code>.bashrc</code>.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">=() {</div><div class="line">input=<span class="string">"<span class="variable">${@//pi/π}</span>"</span></div><div class="line"><span class="built_in">echo</span> <span class="operator">-ne</span> <span class="string">"<span class="variable">$input</span>\nquit"</span> | gcalccmd | sed <span class="string">'s:^&gt; ::g'</span></div><div class="line">}</div></pre></td></tr></table></figure>

<p>For example, <code>= &quot;e^(i*pi)+asin(1)/90&quot;</code> gives <code>0</code>.</p>
<h2 id="GNOME_3_Start_up_applications">GNOME 3 Start up applications</h2>
<p>As of GNOME 3.12, <code>gnome-session-properties</code> is removed. Instead, launch <code>gnome-tweak-tool</code> and go to the corresponding tab. If you cannot add a start up application (the add button not responding), try launching <code>gnome-tweak-tool</code> from your terminal.</p>
<p>To truly manage your start up applications, go to <code>~/.config/autostart/</code> and edit the desktop files there.</p>
<h2 id="Pomodoro_for_GNOME_3">Pomodoro for GNOME 3</h2>
<p>Install AUR package <code>gnome-shell-pomodoro</code>.</p>
<h2 id="Clipboard_management_tool_for_GNOME_3">Clipboard management tool for GNOME 3</h2>
<p>Install AUR package <code>gpaste</code>, restart GNOME shell and enable the extension GPaste.</p>
<h2 id="Convert_video_to_animated_GIF">Convert video to animated GIF</h2>
<p>Adapted From <a href="http://dtbaker.net/random-linux-posts/convert-video-avi-mpeg-mp4-to-a-gif-animation-on-linux/" target="_blank" rel="external">dtbaker</a> and <a href="http://superuser.com/questions/556029/how-do-i-convert-a-video-to-gif-using-ffmpeg-with-reasonable-quality/556031" target="_blank" rel="external">a SuperUser question</a>.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">mkdir frames</div><div class="line">ffmpeg -ss &lt;HH:MM:SS[.XXX]|START_SECONDS&gt; -t&lt;HH:MM:SS[.XXX]|DURATION_SECONDS&gt; -i &lt;YOUR_VIDEO_FILE&gt; [-r &lt;FPS&gt;] <span class="operator">-s</span> &lt;WIDTH_NORMALLY_480&gt;x&lt;HEIGHT_NORMALLY_270&gt; ./frames/frame%<span class="number">04</span>d.png</div><div class="line">convert -delay &lt;<span class="number">100</span>/FPS&gt; -loop <span class="number">0</span> -layers Optimize ./frames/frame*.png output.gif</div></pre></td></tr></table></figure>

<p>If you need to compress your GIF file, use <code>gifsicle</code> or do it <a href="http://ezgif.com/optimize" target="_blank" rel="external">online</a>; for cropping, you also can use <a href="http://ezgif.com/crop" target="_blank" rel="external">this site</a> with option “Crop with Gifsicle” (ImageMagick output seems corrupted).</p>
<h2 id="Convert_SVG_to_PNG_(or_else)">Convert SVG to PNG (or else)</h2>
<pre><code><span class="comment">inkscape</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">export</span><span class="literal">-</span><span class="comment">png=</span>&lt;<span class="comment">OUTPUT_FILE</span>&gt; <span class="literal">-</span><span class="literal">-</span><span class="comment">export</span><span class="literal">-</span><span class="comment">width=</span>&lt;<span class="comment">WIDTH</span>&gt; <span class="literal">-</span><span class="literal">-</span><span class="comment">export</span><span class="literal">-</span><span class="comment">height=</span>&lt;<span class="comment">HEIGHT</span>&gt;
</code></pre><p><code>--export-dpi</code> is also available.</p>
<p>See <code>man inkscape</code> for more formats.</p>
<h2 id="Bitmap_operation">Bitmap operation</h2>
<p>Resize:</p>
<pre><code><span class="title">mogrify</span> -interpolate bicubic -resize <span class="number">50</span>% <span class="regexp">*.png</span>
</code></pre><p>Crop:</p>
<pre><code><span class="title">mogrify</span> -crop 1080x1845+<span class="number">0</span>+<span class="number">75</span> <span class="regexp">*.png</span>
</code></pre><h2 id="Merge_PDFs">Merge PDFs</h2>
<pre><code><span class="input"><span class="prompt">pdfunite &lt;SOURCE_PDF_FILES&gt;</span> &lt;<span class="constant">OUTPUT_PDF_FILE</span>&gt;</span>
</code></pre><h2 id="Convert_GB*_encoded_mp3_tag_to_Unicode">Convert GB* encoded mp3 tag to Unicode</h2>
<p>Install package <code>easytag</code>.</p>
<p>Note that EasyTag may become the handler for MIME type <code>inode/directory</code>, instead of your own file manager, say, Nautilus. You can delete the default association for Easytag and inode/directory in <code>~/.local/share/applications/mimeapps.list</code>, which is managed by <code>gvfs-mime</code>. See also the MIME type section.</p>
<h2 id="MIME_type_handling">MIME type handling</h2>
<p>In GNOME, there are two components managing the default application for a MIME type.</p>
<p>The first one, which is system-wide, can be queried or set via <code>xdg-mime</code>.</p>
<p>The second one, which is a per-user setting, can be queried or set via <code>gvfs-mime</code>, or manually editing <code>~/.local/share/applications/mimeapps.list</code>.</p>
<p>The second one takes precedence, and I guess <code>gvfs-mime</code> is implemented partially for GNOME Open with dialog.</p>
<h2 id="Google_URL_in_Google_Chrome">Google URL in Google Chrome</h2>
<p>Open <code>~/.config/google-chrome/Default/Preferences</code>, edit <code>last_known_google_url</code> and <code>last_prompted_google_url</code>.</p>
<h2 id="Screenshot">Screenshot</h2>
<p>Shortcut keys for screenshot is listed in the search category of its setting.</p>
<ol>
<li><p>Screen to file: <code>PrtSc</code></p>
</li>
<li><p>Window to file: <code>Alt</code> + <code>PrtSc</code></p>
</li>
<li><p>Area to file: <code>Shift</code> + <code>PrtSc</code></p>
</li>
<li><p>To clipboard instead: <code>Ctrl</code> + above</p>
</li>
<li><p>Record: <code>Shift + Ctrl + Alt + R</code></p>
</li>
</ol>
<p>To open a dialog for settings before screenshot, execute <code>gnome-screenshot -i</code>.</p>
<h2 id="Draw_graphs">Draw graphs</h2>
<p>LibreOffice Draw, and use its connectors instead of bare wires. Shift for regular shape and Ctrl + Mouse move for cloning can also be handy.</p>
<h2 id="Render_GFM">Render GFM</h2>
<p>Bash script from <a href="https://gist.github.com/jaburns/33d88f4aa99bb4ab6ad6" target="_blank" rel="external">jaburn’s gist</a>.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="shebang">#!/usr/bin/env bash</span></div><div class="line"></div><div class="line">data=<span class="string">"<span class="variable">$(</span></span></div><div class="line">    cat "$1" \</div><div class="line">      | sed 's/"/\\"/g' \</div><div class="line">      | sed ':a;N;$!ba;s/\n/\\n/g' \</div><div class="line">)"</div><div class="line"></div><div class="line"><span class="keyword">if</span> [[ -z <span class="string">"<span class="variable">$2</span>"</span> ]]; <span class="keyword">then</span></div><div class="line">    context=<span class="string">''</span></div><div class="line"><span class="keyword">else</span></div><div class="line">    context=<span class="string">",\"context\":\"<span class="variable">$2</span>\""</span></div><div class="line"><span class="keyword">fi</span></div><div class="line"></div><div class="line"><span class="built_in">echo</span> <span class="string">'&lt;!DOCTYPE html&gt;'</span></div><div class="line"><span class="built_in">echo</span> <span class="string">'&lt;html&gt;&lt;head&gt;&lt;style&gt;'</span></div><div class="line">curl <span class="operator">-s</span> <span class="string">'https://gist.githubusercontent.com/andyferra/2554919/raw/2e66cabdafe1c9a7f354aa2ebf5bc38265e638e5/github.css'</span></div><div class="line"><span class="built_in">echo</span> <span class="string">'&lt;/style&gt;&lt;/head&gt;&lt;body&gt;'</span></div><div class="line">curl <span class="operator">-s</span> --data <span class="string">"{\"text\":\"<span class="variable">$data</span>\",\"mode\":\"gfm\"<span class="variable">$context</span>}"</span> <span class="string">'https://api.github.com/markdown'</span></div><div class="line"><span class="built_in">echo</span> <span class="string">'&lt;/body&gt;&lt;/html&gt;'</span></div></pre></td></tr></table></figure>


    
	</div>
	<footer class="entry-footer">
		<div class="entry-meta-footer">
			<span class="category">
				
			</span>
			<span class="tags">
				
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/note/">Note</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/software/">Software</a></li></ul>

			</span>
		</div>
	</footer>
	
    
<nav id="article-nav">
  
    <a href="/qsc-mobile-android-v3/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          求是潮手机站 Android 客户端 V3
        
      </div>
    </a>
  
  
    <a href="/android-design-guide/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">
        
          Android 设计简明教程
        
      </div>
    </a>
  
</nav>

  
</article>




<section id="comments">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>

    </div>
    <div class="mb-search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="Search">
    <input type="hidden" name="q" value="site:blog.zhanghai.me">
  </form>
</div>
<footer id="footer">
	<h1 class="footer-blog-title">
		<a href="/">梦断代码</a>
	</h1>
	<span class="copyright">
		&copy; 2015 张海<br>
		Modify from <a href="http://sanographix.github.io/tumblr/apollo/" target="_blank">Apollo</a> theme, designed by <a href="http://www.sanographix.net/" target="_blank">SANOGRAPHIX.NET</a><br>
		Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
	</span>
</footer>
    
<script>
  var disqus_shortname = 'zhanghai';
  
  var disqus_url = 'http://blog.zhanghai.me/arch-linux-notes/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//go.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//cdn.staticfile.org/jquery/2.0.3/jquery.min.js"></script>


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js" type="text/javascript"></script>


  </div>
</body>
</html>